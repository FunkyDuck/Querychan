#!/usr/bin/env php
<?php

$autoload = __DIR__ . '/../vendor/autoload.php';
if(!file_exists($autoload)) {
    $autoload = __DIR__ . "/../../../autoload.php";
}
require_once $autoload;

use FunkyDuck\Querychan\CLI\CommandDispatcher;
use FunkyDuck\Querychan\ORM\Database;

$argv = $_SERVER['argv'];
$argc = $_SERVER['argc'];

$dispatcher = new CommandDispatcher();
if(isset($argv[1])){
    $command = $argv[1];
    
    Database::connect();
    
    $dispatcher->handle($command, array_slice($argv, 2));
} 
else {
    $dispatcher->displayCommands();
}